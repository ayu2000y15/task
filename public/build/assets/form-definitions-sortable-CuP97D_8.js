import{S as l}from"./app-CaxJYKaC.js";function u(){const t=document.getElementById("sortable-definitions");if(t){if(typeof l>"u"){console.error("[FORM DEFINITIONS SORTABLE JS] Sortable object is undefined. Make sure it is installed and imported correctly.");return}try{new l(t,{animation:150,handle:".drag-handle",onEnd:function(n){const i=Array.from(t.children).map(e=>e.dataset.id),a="/admin/form-definitions/reorder",s=document.querySelector('meta[name="csrf-token"]');if(!s){console.error("[FORM DEFINITIONS SORTABLE JS] CSRF token meta tag not found."),alert("エラー: CSRFトークンが見つかりません。ページをリロードしてください。");return}const f=s.getAttribute("content");fetch(a,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f,Accept:"application/json"},body:JSON.stringify({orderedIds:i})}).then(e=>e.ok?e.json():e.json().then(r=>{let o="サーバーエラーが発生しました。";throw r&&r.message?o=r.message:r&&r.error&&(o=r.error),new Error(o+` (Status: ${e.status})`)})).then(e=>{if(e.success)i.forEach((r,o)=>{const c=t.querySelector(`tr[data-id="${r}"]`);if(c){const d=c.querySelector("td:nth-child(2)");d&&(d.textContent=o)}});else{let r=e.error||e.message||"並び順の更新に失敗しました。";console.error("[FORM DEFINITIONS SORTABLE JS] Failed to update order:",r),alert("エラー: "+r)}}).catch(e=>{console.error("[FORM DEFINITIONS SORTABLE JS] Error during fetch for reorder:",e),alert("エラー: "+e.message||"並び順の更新中に技術的な問題が発生しました。")})}})}catch(n){console.error("[FORM DEFINITIONS SORTABLE JS] Error initializing Sortable:",n)}}}export{u as initFormDefinitionSortable};
