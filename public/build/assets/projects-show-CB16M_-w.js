import{a as o}from"./app-BHqKxE5M.js";function f(){const a=document.getElementById("project-show-main-container");if(!a)return;const c=a.dataset.projectId;a.addEventListener("change",function(e){var i;const r=e.target.closest(".material-status-checkbox");if(!r)return;const t=r.dataset.url,u=r.checked?"購入済":"未購入",d=(i=r.closest("[data-character-id]"))==null?void 0:i.dataset.characterId;if(!t||!d||!c){console.error("Missing data attributes for material status update.");return}o.patch(t,{status:u}).then(s=>{s.data.success?n(c,d):(r.checked=!r.checked,alert("材料ステータスの更新に失敗しました: "+(s.data.message||"")))}).catch(s=>{console.error("Error updating material status:",s),r.checked=!r.checked,alert("材料ステータス更新中にエラーが発生しました。")})}),a.addEventListener("submit",function(e){const r=e.target.closest(".add-cost-form"),t=e.target.closest(".delete-cost-form");r?(e.preventDefault(),h(r,c)):t&&(e.preventDefault(),m(t,c))})}function h(a,c){const e=a.dataset.characterId,r=new FormData(a);if(!e){console.error("Missing data attributes for cost form.");return}o.post(a.action,r).then(t=>{t.status===200||t.status===201||t.data&&t.data.success?n(c,e):l(t)}).catch(t=>{console.error("Error adding cost:",t.response||t),l(t.response,"コスト追加中にエラーが発生しました。")})}function m(a,c){var r;const e=(r=a.closest("[data-character-id]"))==null?void 0:r.dataset.characterId;if(!e){console.error("Missing data for cost deletion.");return}confirm("このコストを削除しますか？")&&o.post(a.action,new FormData(a)).then(t=>{t.status===200||t.data&&t.data.success?n(c,e):alert("コストの削除に失敗しました: "+(t.data.message||""))}).catch(t=>{console.error("Error deleting cost:",t),alert("コスト削除中にエラーが発生しました。")})}function n(a,c){const e=document.getElementById(`costs-content-${c}`);if(!e){console.warn(`Could not find the costs tab container for character: ${c}`);return}const r=`/projects/${a}/characters/${c}/costs-partial`;o.get(r).then(t=>{e.innerHTML=t.data}).catch(t=>{console.error("Error refreshing costs list:",t),alert("コスト情報エリアの更新に失敗しました。サーバー側の処理が実装されているか確認してください。(404 Not Found)")})}function l(a,c="処理に失敗しました。"){let e=c;a&&a.data&&(a.data.message?e=a.data.message:a.data.errors&&(e=Object.values(a.data.errors).flat().join(`
`))),alert(e)}f();
